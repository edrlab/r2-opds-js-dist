{"version":3,"file":"test-JSON-XML-Date.js","sourceRoot":"","sources":["../../../test/test-JSON-XML-Date.ts"],"names":[],"mappings":";;AAAA,wDAA2C;AAC3C,6BAA2B;AAC3B,qCAAyC;AACzC,iCAAiC;AAEjC,2DAGkC;AAClC,6DAAqD;AACrD,2FAAsF;AACtF,uCAMmB;AAEnB,2CAA4B,EAAE,CAAC;AAC/B,wCAAyB,EAAE,CAAC;AAI5B,MAAM,IAAI,GAAG,IAAI,IAAI,EAAE,CAAC;AAExB,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;AAElC,IAAI,CAAC,WAAW,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,CAAC;AAElC,MAAM,OAAO,GAAG,0BAA0B,CAAC;AAI3C,UAAI,CAAC,0DAA0D,EAAE,CAAC,CAAC,EAAE,EAAE;IAEnE,MAAM,EAAE,GAAG,IAAI,mDAAuB,EAAE,CAAC;IACzC,EAAE,CAAC,QAAQ,GAAG,IAAI,CAAC;IACnB,iBAAO,CAAC,EAAE,CAAC,CAAC;IAEZ,MAAM,IAAI,GAAG,cAAM,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;IAClC,iBAAO,CAAC,IAAI,CAAC,CAAC;IAEd,0BAAgB,CAAC,CAAC,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;IACnC,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;AACjC,CAAC,CAAC,CAAC;AAIH,UAAI,CAAC,4DAA4D,EAAE,CAAC,CAAC,EAAE,EAAE;IAErE,MAAM,IAAI,GAAQ,EAAE,CAAC;IACrB,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC;IACxB,iBAAO,CAAC,IAAI,CAAC,CAAC;IAEd,MAAM,EAAE,GAA4B,cAAM,CAAC,WAAW,CAA0B,IAAI,EAAE,mDAAuB,CAAC,CAAC;IAC/G,iBAAO,CAAC,EAAE,CAAC,CAAC;IAEZ,mBAAS,CAAC,CAAC,EAAE,EAAE,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;IAChC,mBAAS,CAAC,CAAC,EAAE,EAAE,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;AACpC,CAAC,CAAC,CAAC;AAqBH,UAAI,CAAC,6CAA6C,EAAE,CAAC,CAAC,EAAE,EAAE;IAEtD,MAAM,MAAM,GACR;4BACoB,OAAO;iBAClB,CAAC;IACd,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;IAEpB,MAAM,GAAG,GAAG,IAAI,MAAM,CAAC,SAAS,EAAE,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;IAC3D,MAAM,EAAE,GAAU,mBAAG,CAAC,WAAW,CAAQ,GAAG,EAAE,kBAAK,CAAC,CAAC;IACrD,iBAAO,CAAC,EAAE,CAAC,CAAC;IAEZ,mBAAS,CAAC,CAAC,EAAE,EAAE,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;IAC/B,mBAAS,CAAC,CAAC,EAAE,EAAE,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;AACnC,CAAC,CAAC,CAAC","sourcesContent":["import { XML } from \"@utils/xml-js-mapper\";\nimport { test } from \"ava\";\nimport { JSON as TAJSON } from \"ta-json\";\nimport * as xmldom from \"xmldom\";\n\nimport {\n    initGlobalConverters_GENERIC,\n    initGlobalConverters_OPDS,\n} from \"../src/opds/init-globals\";\nimport { Entry } from \"../src/opds/opds1/opds-entry\";\nimport { OPDSPublicationMetadata } from \"../src/opds/opds2/opds2-publicationMetadata\";\nimport {\n    checkDate,\n    checkType,\n    checkType_String,\n    inspect,\n    logJSON,\n} from \"./helpers\";\n\ninitGlobalConverters_GENERIC();\ninitGlobalConverters_OPDS();\n\n// ==========================\n\nconst date = new Date();\n// 31st December (0-based index) 2000\ndate.setUTCFullYear(2000, 11, 31);\n// 23 hours, 59 minutes, 59 seconds, 999 milliseconds\ndate.setUTCHours(23, 59, 59, 999);\n\nconst dateSTR = \"2000-12-31T23:59:59.999Z\";\n\n// ==========================\n\ntest(\"JSON SERIALIZE: OPDSPublicationMetadata.Modified => Date\", (t) => {\n\n    const md = new OPDSPublicationMetadata();\n    md.Modified = date;\n    inspect(md);\n\n    const json = TAJSON.serialize(md);\n    logJSON(json);\n\n    checkType_String(t, json.modified);\n    t.is(json.modified, dateSTR);\n});\n\n// ==========================\n\ntest(\"JSON DESERIALIZE: OPDSPublicationMetadata.Modified => Date\", (t) => {\n\n    const json: any = {};\n    json.modified = dateSTR;\n    logJSON(json);\n\n    const md: OPDSPublicationMetadata = TAJSON.deserialize<OPDSPublicationMetadata>(json, OPDSPublicationMetadata);\n    inspect(md);\n\n    checkType(t, md.Modified, Date);\n    checkDate(t, md.Modified, date);\n});\n\n// ==========================\n\n// SERIALIZATION not implemented in xml-js-mapper!\n// test(\"XML SERIALIZE: OPDS Entry.Updated => Date\", (t) => {\n\n//     const e = new Entry();\n//     e.Updated = date;\n//     inspect(e);\n\n//     const xml = XML.serialize(e);\n//     logXML(xml);\n\n//     const xmlProp = xml.select(\"atom:updated/text()\");\n//     checkType_String(t, xmlProp);\n//     t.is(xmlProp, dateSTR);\n// });\n\n// ==========================\n\ntest(\"XML DESERIALIZE: OPDS Entry.Updated => Date\", (t) => {\n\n    const xmlStr =\n        `<entry xmlns=\"http://opds-spec.org/2010/catalog\" xmlns:atom=\"http://www.w3.org/2005/Atom\">\n            <atom:updated>${dateSTR}</atom:updated>\n        </entry>`;\n    console.log(xmlStr);\n\n    const xml = new xmldom.DOMParser().parseFromString(xmlStr);\n    const md: Entry = XML.deserialize<Entry>(xml, Entry);\n    inspect(md);\n\n    checkType(t, md.Updated, Date);\n    checkDate(t, md.Updated, date);\n});\n"]}