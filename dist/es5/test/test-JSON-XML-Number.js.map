{"version":3,"file":"test-JSON-XML-Number.js","sourceRoot":"","sources":["../../../test/test-JSON-XML-Number.ts"],"names":[],"mappings":";;AAAA,2BAAuB;AACvB,+BAAiC;AAEjC,wDAA6E;AAC7E,mEAAwD;AAExD,yDAAmG;AACnG,+CAA8C;AAC9C,mEAAgE;AAChE,qCAA4E;AAE5E,wCAAyB,EAAE,CAAC;AAC5B,2CAA4B,EAAE,CAAC;AAI/B,IAAM,GAAG,GAAG,WAAW,CAAC;AACxB,IAAM,MAAM,GAAG,YAAY,CAAC;AAI5B,aAAI,CAAC,iDAAiD,EAAE,UAAC,CAAC;IAEtD,IAAM,EAAE,GAAG,IAAI,6BAAY,EAAE,CAAC;IAC9B,EAAE,CAAC,YAAY,GAAG,GAAG,CAAC;IACtB,iBAAO,CAAC,EAAE,CAAC,CAAC;IAEZ,IAAM,IAAI,GAAG,8BAAe,CAAC,EAAE,CAAC,CAAC;IACjC,iBAAO,CAAC,IAAI,CAAC,CAAC;IAEd,0BAAgB,CAAC,CAAC,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;IACvC,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,YAAY,EAAE,GAAG,CAAC,CAAC;AACjC,CAAC,CAAC,CAAC;AAIH,aAAI,CAAC,mDAAmD,EAAE,UAAC,CAAC;IAExD,IAAM,IAAI,GAAQ,EAAE,CAAC;IACrB,IAAI,CAAC,YAAY,GAAG,GAAG,CAAC;IACxB,iBAAO,CAAC,IAAI,CAAC,CAAC;IAEd,IAAM,EAAE,GAAiB,gCAAiB,CAAe,IAAI,EAAE,6BAAY,CAAC,CAAC;IAC7E,iBAAO,CAAC,EAAE,CAAC,CAAC;IACZ,CAAC,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,cAAc,KAAK,WAAW,CAAC,CAAC;IAEjD,0BAAgB,CAAC,CAAC,EAAE,EAAE,CAAC,YAAY,CAAC,CAAC;IACrC,qBAAW,CAAC,CAAC,EAAE,EAAE,CAAC,YAAY,EAAE,GAAG,CAAC,CAAC;AACzC,CAAC,CAAC,CAAC;AAqBH,aAAI,CAAC,yDAAyD,EAAE,UAAC,CAAC;IAE9D,IAAM,MAAM,GACR,wJAC+B,MAAM,gDAC7B,CAAC;IACb,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;IAEpB,IAAM,GAAG,GAAG,IAAI,MAAM,CAAC,SAAS,EAAE,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;IAC3D,IAAM,IAAI,GAAS,mBAAG,CAAC,WAAW,CAAO,GAAG,EAAE,WAAI,CAAC,CAAC;IACpD,iBAAO,CAAC,IAAI,CAAC,CAAC;IAEd,0BAAgB,CAAC,CAAC,EAAE,IAAI,CAAC,sBAAsB,CAAC,CAAC;IACjD,qBAAW,CAAC,CAAC,EAAE,IAAI,CAAC,sBAAsB,EAAE,GAAG,CAAC,CAAC;AACrD,CAAC,CAAC,CAAC","sourcesContent":["import test from \"ava\";\nimport * as xmldom from \"xmldom\";\n\nimport { TaJsonDeserialize, TaJsonSerialize } from \"@r2-lcp-js/serializable\";\nimport { XML } from \"@r2-utils-js/_utils/xml-js-mapper\";\n\nimport { initGlobalConverters_GENERIC, initGlobalConverters_OPDS } from \"../src/opds/init-globals\";\nimport { OPDS } from \"../src/opds/opds1/opds\";\nimport { OPDSMetadata } from \"../src/opds/opds2/opds2-metadata\";\nimport { checkNumber, checkType_Number, inspect, logJSON } from \"./helpers\";\n\ninitGlobalConverters_OPDS();\ninitGlobalConverters_GENERIC();\n\n// ==========================\n\nconst num = 12345.67890;\nconst numSTR = \"12345.6789\";\n\n// ==========================\n\ntest(\"JSON SERIALIZE: Metadata.ItemsPerPage => Number\", (t) => {\n\n    const md = new OPDSMetadata();\n    md.ItemsPerPage = num;\n    inspect(md);\n\n    const json = TaJsonSerialize(md);\n    logJSON(json);\n\n    checkType_Number(t, json.itemsPerPage);\n    t.is(json.itemsPerPage, num);\n});\n\n// ==========================\n\ntest(\"JSON DESERIALIZE: Metadata.ItemsPerPage => Number\", (t) => {\n\n    const json: any = {};\n    json.itemsPerPage = num;\n    logJSON(json);\n\n    const md: OPDSMetadata = TaJsonDeserialize<OPDSMetadata>(json, OPDSMetadata);\n    inspect(md);\n    t.true(typeof md.AdditionalJSON === \"undefined\");\n\n    checkType_Number(t, md.ItemsPerPage);\n    checkNumber(t, md.ItemsPerPage, num);\n});\n\n// ==========================\n\n// SERIALIZATION not implemented in xml-js-mapper!\n// test(\"XML SERIALIZE: OPDS opensearch:itemsPerPage => Number\", (t) => {\n\n//     const e = new OPDS();\n//     e.OpensearchItemsPerPage = num;\n//     inspect(e);\n\n//     const xml = XML.serialize(e);\n//     logXML(xml);\n\n//     const xmlProp = xml.select(\"opensearch:itemsPerPage/text()\");\n//     checkType_String(t, xmlProp);\n//     t.is(xmlProp, numSTR);\n// });\n\n// ==========================\n\ntest(\"XML DESERIALIZE: OPDS opensearch:itemsPerPage => Number\", (t) => {\n\n    const xmlStr =\n        `<opds xmlns=\"http://opds-spec.org/2010/catalog\" xmlns:opensearch=\"http://a9.com/-/spec/opensearch/1.1/\">\n            <opensearch:itemsPerPage>${numSTR}</opensearch:itemsPerPage>\n        </opds>`;\n    console.log(xmlStr);\n\n    const xml = new xmldom.DOMParser().parseFromString(xmlStr);\n    const opds: OPDS = XML.deserialize<OPDS>(xml, OPDS);\n    inspect(opds);\n\n    checkType_Number(t, opds.OpensearchItemsPerPage);\n    checkNumber(t, opds.OpensearchItemsPerPage, num);\n});\n"]}